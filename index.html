<!DOCTYPE html>
<html lang="ua">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ціна за кілограм</title>
    <link rel="manifest" href="manifest.webmanifest" />
    <style>
      h1,
      h2 {
        text-align: center;
      }
      .grid {
        display: grid;
        grid-template-columns: 80vw;
        justify-content: center;
      }
      form {
        display: grid;
        grid-gap: 10px;
      }
      input,
      button {
        height: 30px;
      }
    </style>
  </head>
  <body>
    <h1>Ціна за кілограм</h1>
    <div class="grid">
      <form name="weight">
        <input name="price" type="number" placeholder="Ціна" required />
        <input name="volume" type="number" placeholder="Об'єм" required />
        <button type="submit">Розрахувати</button>
      </form>
      <p id="weightResult">Ціна за кілограм/міліграм:</p>
    </div>
    <h2>Калькулятор відсотків</h2>
    <div class="grid">
      <p id="precentResult20"></p>
      <p id="precentResult30"></p>
      <p id="precentResult50"></p>
    </div>
    <footer>
      <button class="add-button">Додати на головний екран</button>
    </footer>
    <script>
      const weightResult = document.getElementById('weightResult');
      const precentResult20 = document.getElementById('precentResult20');
      const precentResult30 = document.getElementById('precentResult30');
      const precentResult50 = document.getElementById('precentResult50');
      const form = document.forms.weight;
      function percentResult(percent, result) {
        const formData = new FormData(form);
        const price = formData.get('price');
        result.innerText = `-${percent}% : ${
          price - (price / 100) * percent
        } грн.`;
      }
      form.addEventListener('submit', (e) => {
        e.preventDefault();
        const formData = new FormData(form);
        const price = formData.get('price');
        const volume = formData.get('volume');
        weightResult.innerText += ` ${((price / volume) * 1000).toFixed(
          2,
        )} грн.`;
      });
      form.addEventListener('input', () => {
        percentResult(20, precentResult20);
        percentResult(30, precentResult30);
        percentResult(50, precentResult50);
      });

      let deferredPrompt;
      const addBtn = document.querySelector('.add-button');
      addBtn.style.display = 'none';
      window.addEventListener('beforeinstallprompt', (e) => {
        // Prevent Chrome 67 and earlier from automatically showing the prompt
        e.preventDefault();
        // Stash the event so it can be triggered later.
        deferredPrompt = e;
        // Update UI to notify the user they can add to home screen
        addBtn.style.display = 'block';

        addBtn.addEventListener('click', (e) => {
          // hide our user interface that shows our A2HS button
          addBtn.style.display = 'none';
          // Show the prompt
          deferredPrompt.prompt();
          // Wait for the user to respond to the prompt
          deferredPrompt.userChoice.then((choiceResult) => {
            if (choiceResult.outcome === 'accepted') {
              console.log('User accepted the A2HS prompt');
            } else {
              console.log('User dismissed the A2HS prompt');
            }
            deferredPrompt = null;
          });
        });
      });
    </script>
  </body>
</html>
